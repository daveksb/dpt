<div class="page-content">
  <div class="main-container">
    <div class="request-label header-1">บริการข้อมูล</div>
    <div class="data-service-main">
      <div class="data-service-header">
        <div class="search-container">
          <div class="search-input-container">
            <mat-form-field class="form-field" appearance="outline">
              <input
                type="text"
                matInput
                [formControl]="form"
                placeholder="ค้นหา"
              />
              <span matPrefix>
                <mat-icon>search</mat-icon>
              </span>
            </mat-form-field>
          </div>
          <div class="category-container">
            <mat-form-field appearance="outline">
              <mat-select
                placeholder="เลือก 1 หมวดหมู่"
                [formControl]="selectForm"
              >
                <mat-option
                  *ngFor="let item of departmentList"
                  [value]="item.departmentName"
                >
                  {{ item.departmentName }}
                </mat-option>
              </mat-select>
            </mat-form-field>
          </div>
          <div class="search-button-container">
            <button
              mat-flat-button
              class="default-button big-button"
              color="primary"
              (click)="onSearch()"
            >
              ค้นหา
            </button>
          </div>
          <div class="request-button-container">
            <button
              mat-stroked-button
              class="default-button big-button"
              color="primary"
              (click)="onRequest()"
              *ngIf="canRequest"
            >
              ร้องขอชุดข้อมูล
            </button>
          </div>
        </div>
      </div>
      <div class="data-service-body">
        <div class="data-service-side-bar">
          <div class="side-bar-header">กลุ่มชุดข้อมูล</div>
          <div
            class="side-bar-item"
            *ngFor="let item of sideBarList"
            (click)="onClickFilterCategory(item.value)"
            [ngClass]="{
              'side-bar-item--active': currentCategory === item.value
            }"
          >
            <img
              class="side-bar-icon"
              [src]="'assets/icon/' + mapCategory[item.value]"
            />
            <div class="side-bar-label">
              {{ item.value }} ({{ item.count }})
            </div>
          </div>
          <ng-container [formGroup]="formGroup">
            <div class="side-bar-item-form">
              <mat-form-field appearance="fill">
                <mat-label>ภูมิภาค</mat-label>
                <mat-select formControlName="zoneName" multiple>
                  <mat-option
                    *ngFor="let zone of zones"
                    [value]="zone.ZONE_NAME"
                    >{{ zone.ZONE_NAME }}</mat-option
                  >
                </mat-select>
              </mat-form-field>
            </div>
            <div class="side-bar-item-form">
              <mat-form-field appearance="fill">
                <mat-label>จังหวัด</mat-label>
                <mat-select formControlName="province" multiple>
                  <mat-option
                    *ngFor="let province of currentProvinceList"
                    [value]="province.provinceCode"
                    >{{ province.provinceName }}</mat-option
                  >
                </mat-select>
              </mat-form-field>
            </div>
            <div class="side-bar-item-form">
              <mat-form-field appearance="fill">
                <mat-label>รูปแบบข้อมูล</mat-label>
                <mat-select formControlName="dataType" multiple>
                  <mat-option
                    *ngFor="let dataType of dataTypeList"
                    [value]="dataType.tType"
                    >{{ dataType.tType | uppercase }}</mat-option
                  >
                </mat-select>
              </mat-form-field>
            </div>
          </ng-container>
        </div>
        <div class="data-service-content">
          <div *ngIf="currentData.length > 0" class="data-service-list">
            <div
              class="data-service-item"
              *ngFor="let item of currentData"
              (click)="onNavigateData(item.apiId)"
            >
              <div class="item-image">
                <div *ngIf="!item.picture" class="image"></div>
                <img
                  *ngIf="item.picture"
                  class="profile-image"
                  [src]="item.tempPicture"
                />
              </div>
              <div class="item-content">
                <div class="item-header">
                  <div class="department-container">
                    {{ item.departmentName }}
                  </div>
                  <div class="category-container">
                    {{ item.catName }}
                  </div>
                </div>
                <div class="item-body-container">
                  <div class="topic-container">
                    {{ item.apiName }}
                  </div>
                  <div class="sub-topic-container">
                    {{ item.apiDetail }}
                  </div>
                  <div class="file-container">
                    <dpt-file-button
                      [formatType]="item.tType"
                    ></dpt-file-button>

                    <button
                      mat-flat-button
                      [disableRipple]="true"
                      class="default-button activate-button disabled-button"
                      [ngClass]="{ 'warning-button': item.zone === 'PV' }"
                    >
                      <div class="button-item">
                        <div class="privacy-label">
                          {{ item.privacyName }}
                        </div>
                      </div>
                    </button>
                  </div>
                </div>
                <div class="item-footer">
                  <div class="icon-container">
                    <mat-icon>visibility</mat-icon>
                  </div>
                  {{ item.countView }} Views
                </div>
              </div>
            </div>
          </div>
          <ng-container *ngIf="currentData.length === 0">
            <div class="no-data-container">
              <div class="no-data-item">
                <div class="search-icon-container">
                  <img class="search-icon" src="assets/icon/search.svg" />
                </div>
                <div class="search-label">ค้นหาข้อมูลไม่พบ</div>
                <div class="search-detail">
                  ใช้คำอื่นที่แตกต่างหรือเปลี่ยนคำที่ต้องการค้นหา
                </div>
              </div>
            </div>
          </ng-container>
          <div class="data-service-pagination"></div>
        </div>
      </div>
    </div>
  </div>
</div>
