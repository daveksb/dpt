<div mat-dialog-title class="request-form-header">
  <div class="request-form-header-label">
    {{ isEdit ? 'แก้ไขชุดข้อมูล' : 'เพิ่มชุดข้อมูล' }}
  </div>
  <button mat-button (click)="onDismiss()" cdkFocusInitial>X</button>
</div>

<div mat-dialog-content>
  <div class="request-form-container" [formGroup]="formGroup">
    <div class="label-1">รูปแบบข้อมูล</div>
    <div class="value-1">
      <mat-form-field appearance="outline">
        <mat-select placeholder="รูปแบบข้อมูล" formControlName="typeId">
          <mat-option
            *ngFor="let item of dataTypeList"
            [value]="item.tId.toString()"
          >
            {{ item.tType }}
          </mat-option>
        </mat-select>
      </mat-form-field>
    </div>
    <div class="label-2">ชื่อชุดข้อมูล</div>
    <div class="value-2">
      <mat-form-field class="form-field" appearance="outline">
        <input
          type="text"
          matInput
          formControlName="apiName"
          placeholder="ชื่อชุดข้อมูล"
        />
      </mat-form-field>
    </div>
    <div *ngIf="!isEdit" class="label-3">วันที่จัดทำข้อมูล</div>
    <div *ngIf="!isEdit" class="value-3">
      <!-- <mat-form-field class="form-field" appearance="outline">
        <input
          type="date"
          matInput
          formControlName="createInfoDate"
          placeholder="วันที่จัดทำข้อมูล"
        />
      </mat-form-field> -->

      <mat-form-field appearance="fill" class="example-form-field">
        <input
          matInput
          [matDatepicker]="datepicker"
          formControlName="createInfoDate"
        />
        <mat-hint>วว/ดด/ปปปป</mat-hint>
        <mat-datepicker-toggle
          matSuffix
          [for]="datepicker"
        ></mat-datepicker-toggle>
        <mat-datepicker #datepicker> </mat-datepicker>
      </mat-form-field>
    </div>
    <div class="label-4">รูปภาพประกอบ</div>
    <div class="value-4">
      <input
        type="file"
        accept="image/png,image/jpg,image/jpeg"
        formControlName="tempPicture"
        placeholder="รูปภาพประกอบ"
        (change)="onFileChange($event)"
      />
      <div style="color: red" *ngIf="formGroup.get('tempPicture')?.invalid">
        File size over 500 KB.
      </div>
    </div>

    <div class="label-5">รายละเอียด</div>
    <div class="value-5">
      <mat-form-field class="form-field" appearance="outline">
        <textarea
          type="text"
          matInput
          formControlName="apiDetail"
          placeholder="รายละเอียด"
        ></textarea>
      </mat-form-field>
    </div>
    <div class="label-6">{{ isAPI ? 'รายละเอียดAPI' : 'รายละเอียดไฟล์' }}</div>
    <div class="value-6">
      <quill-editor formControlName="tempDetail"> </quill-editor>
    </div>

    <div class="label-7">{{ isAPI ? 'Link' : 'ซื่อไฟล์' }}</div>
    <div class="value-7">
      <mat-form-field class="form-field" appearance="outline">
        <input
          type="text"
          matInput
          formControlName="apiLink"
          [placeholder]="isAPI ? 'Link' : 'ซื่อไฟล์'"
        />
      </mat-form-field>
      <div class="file-size" *ngIf="fileSize">ขนาดไฟล์ : {{ fileSize }}</div>
    </div>

    <ng-container *ngIf="isAPI">
      <div class="label-8">ตารางข้อมูล</div>
      <div class="value-8">
        <button
          class="float-left"
          mat-icon-button
          color="primary"
          (click)="addRow()"
        >
          <mat-icon>add_circle_outline</mat-icon>
          เพิ่มแถว
        </button>
        <form class="basic-container" [formGroup]="jsonForm">
          <div formArrayName="form">
            <div
              class="table-row"
              *ngFor="let formRow of formArray; let i = index"
              [formGroupName]="i"
            >
              <mat-form-field class="form-field" appearance="outline">
                <mat-label>Name</mat-label>

                <input
                  type="text"
                  matInput
                  formControlName="name"
                  placeholder="name"
                />
              </mat-form-field>
              <mat-form-field class="form-field" appearance="outline">
                <mat-label>Type</mat-label>
                <input
                  type="text"
                  matInput
                  formControlName="type"
                  placeholder="type"
                />
              </mat-form-field>
              <mat-form-field class="form-field" appearance="outline">
                <mat-label>Description</mat-label>
                <input
                  type="text"
                  matInput
                  formControlName="description"
                  placeholder="description"
                />
              </mat-form-field>
              <mat-form-field class="form-field" appearance="outline">
                <mat-label>Default</mat-label>
                <input
                  type="text"
                  matInput
                  placeholder="default"
                  formControlName="default"
                />
              </mat-form-field>
              <button
                class="float-left"
                mat-icon-button
                color="primary"
                aria-label="Remove/clear"
                (click)="deleteRow(i)"
                matTooltip="Remove"
              >
                <mat-icon>highlight_off</mat-icon>
              </button>
            </div>
          </div>
        </form>
      </div>
    </ng-container>

    <div class="label-9">หมวดหมู่</div>
    <div class="value-9 double-column">
      <mat-form-field appearance="outline">
        <mat-select placeholder="หมวดหมู่" formControlName="catId">
          <mat-option
            *ngFor="let item of categoryList"
            [value]="item.catId.toString()"
          >
            {{ item.catName }}
          </mat-option>
        </mat-select>
      </mat-form-field>
    </div>
    <div class="label-10">การเปิดเผยข้อมูล</div>
    <div class="value-10 double-column">
      <mat-form-field appearance="outline">
        <mat-select placeholder="การเปิดเผยข้อมูล" formControlName="privacyId">
          <mat-option
            *ngFor="let item of privacyList"
            [value]="item.privacyId.toString()"
          >
            {{ item.privacyName }}
          </mat-option>
        </mat-select>
      </mat-form-field>
      <mat-form-field appearance="outline">
        <mat-select placeholder="สถานะ" formControlName="status">
          <mat-option
            *ngFor="let item of statusList"
            [value]="item.value.toString()"
          >
            {{ item.label }}
          </mat-option>
        </mat-select>
      </mat-form-field>
    </div>
    <div class="label-11">จังหวัด</div>
    <div class="value-11">
      <mat-form-field class="form-field" appearance="outline">
        <mat-select placeholder="จังหวัด" formControlName="provinceCode">
          <mat-option
            *ngFor="let item of provinceList"
            [value]="item.provinceCode.toString()"
          >
            {{ item.provinceName }}
          </mat-option>
        </mat-select>
      </mat-form-field>
    </div>
  </div>
  <button *ngIf="!isAPI" class="float-left" mat-icon-button (click)="addFile()">
    <mat-icon>add_circle_outline</mat-icon>
    {{ hasFile ? 'แก้ไขไฟล์' : 'เพิ่มไฟล์' }}
  </button>
</div>
<mat-dialog-actions>
  <button mat-button (click)="onDismiss()">ยกเลิก</button>
  <button mat-button [disabled]="formGroup.invalid" (click)="onConfirm()">
    ตกลง
  </button>
</mat-dialog-actions>
